# æ™ºèƒ½è½¯ä»¶åˆ†æè®¾è®¡å·¥å…· - åç«¯æ¥å£éœ€æ±‚æ–‡æ¡£

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

æœ¬æ–‡æ¡£å®šä¹‰äº†æ™ºèƒ½è½¯ä»¶åˆ†æè®¾è®¡å·¥å…·çš„åç«¯APIæ¥å£éœ€æ±‚ï¼ŒåŒ…æ‹¬åŠŸèƒ½æ ‘ã€ç”¨ä¾‹å›¾ã€æ•°æ®æ¨¡å‹ã€ERå›¾å’Œå…·ä½“çš„APIæ¥å£è®¾è®¡ã€‚

## ğŸŒ³ åŠŸèƒ½æ ‘

```
æ™ºèƒ½è½¯ä»¶åˆ†æè®¾è®¡å·¥å…·åç«¯ç³»ç»Ÿ
â”œâ”€â”€ ç”¨æˆ·ç®¡ç†æ¨¡å—
â”‚   â”œâ”€â”€ ç”¨æˆ·æ³¨å†Œ/ç™»å½•
â”‚   â”œâ”€â”€ ç”¨æˆ·ä¿¡æ¯ç®¡ç†
â”‚   â”œâ”€â”€ æƒé™æ§åˆ¶
â”‚   â””â”€â”€ ä¼šè¯ç®¡ç†
â”œâ”€â”€ é¡¹ç›®ç®¡ç†æ¨¡å—
â”‚   â”œâ”€â”€ é¡¹ç›®åˆ›å»º/åˆ é™¤
â”‚   â”œâ”€â”€ é¡¹ç›®ä¿¡æ¯ç®¡ç†
â”‚   â”œâ”€â”€ é¡¹ç›®æˆå‘˜ç®¡ç†
â”‚   â””â”€â”€ é¡¹ç›®ç‰ˆæœ¬æ§åˆ¶
â”œâ”€â”€ æ ¸å¿ƒä¸šåŠ¡èµ„äº§æ¨¡å—
â”‚   â”œâ”€â”€ ç”¨ä¾‹å›¾ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ å‚ä¸è€…ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ ç”¨ä¾‹ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ å…³ç³»ç®¡ç†
â”‚   â”‚   â””â”€â”€ å›¾è¡¨ç”Ÿæˆ
â”‚   â”œâ”€â”€ é¢†åŸŸæ¨¡å‹ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ å®ä½“ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ å±æ€§ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ å…³ç³»ç®¡ç†
â”‚   â”‚   â””â”€â”€ çŸ¥è¯†å›¾è°±ç”Ÿæˆ
â”‚   â””â”€â”€ ä¸šåŠ¡æµç¨‹ç®¡ç†
â”‚       â”œâ”€â”€ æµç¨‹èŠ‚ç‚¹ç®¡ç†
â”‚       â”œâ”€â”€ æµç¨‹è¿æ¥ç®¡ç†
â”‚       â””â”€â”€ æµç¨‹å›¾ç”Ÿæˆ
â”œâ”€â”€ æ–‡æ¡£ç”Ÿæˆæ¨¡å—
â”‚   â”œâ”€â”€ AIåˆ†æå¼•æ“
â”‚   â”œâ”€â”€ æ¨¡æ¿ç®¡ç†
â”‚   â”œâ”€â”€ æ–‡æ¡£ç”Ÿæˆå™¨
â”‚   â””â”€â”€ æ–‡æ¡£ç‰ˆæœ¬ç®¡ç†
â”œâ”€â”€ ä»£ç åˆ†ææ¨¡å—
â”‚   â”œâ”€â”€ ä»£ç ä¸Šä¼ å¤„ç†
â”‚   â”œâ”€â”€ é™æ€ä»£ç åˆ†æ
â”‚   â”œâ”€â”€ ä¾èµ–å…³ç³»åˆ†æ
â”‚   â””â”€â”€ ä»£ç è´¨é‡è¯„ä¼°
â”œâ”€â”€ ç³»ç»Ÿæ¶æ„æ¨¡å—
â”‚   â”œâ”€â”€ æ¨¡å—ç®¡ç†
â”‚   â”œâ”€â”€ è¿æ¥ç®¡ç†
â”‚   â”œâ”€â”€ åˆ†å±‚ç®¡ç†
â”‚   â””â”€â”€ æ¶æ„å›¾ç”Ÿæˆ
â”œâ”€â”€ å®ä½“æ¨¡å‹æ¨¡å—
â”‚   â”œâ”€â”€ æ•°æ®åº“å®ä½“ç®¡ç†
â”‚   â”œâ”€â”€ å­—æ®µç®¡ç†
â”‚   â”œâ”€â”€ å…³ç³»ç®¡ç†
â”‚   â””â”€â”€ SQLè„šæœ¬ç”Ÿæˆ
â”œâ”€â”€ æ–‡ä»¶ç®¡ç†æ¨¡å—
â”‚   â”œâ”€â”€ æ–‡ä»¶ä¸Šä¼ 
â”‚   â”œâ”€â”€ æ–‡ä»¶å­˜å‚¨
â”‚   â”œâ”€â”€ æ–‡ä»¶é¢„è§ˆ
â”‚   â””â”€â”€ æ–‡ä»¶å¯¼å‡º
â”œâ”€â”€ Gité›†æˆæ¨¡å—
â”‚   â”œâ”€â”€ ä»“åº“è¿æ¥
â”‚   â”œâ”€â”€ åˆ†æ”¯ç®¡ç†
â”‚   â”œâ”€â”€ æäº¤ç®¡ç†
â”‚   â””â”€â”€ åŒæ­¥ç®¡ç†
â””â”€â”€ MCPåè®®æ¨¡å—
    â”œâ”€â”€ MCPæœåŠ¡å™¨
    â”œâ”€â”€ Agentæ¥å£
    â”œâ”€â”€ åè®®é€‚é…
    â””â”€â”€ æ’ä»¶ç®¡ç†
```

## ğŸ¯ æ ¸å¿ƒç”¨ä¾‹å›¾

### ç”¨æˆ·ç®¡ç†ç”¨ä¾‹
```mermaid
graph TB
    User[ç”¨æˆ·]
    Admin[ç®¡ç†å‘˜]
    
    User --> UC1[æ³¨å†Œè´¦æˆ·]
    User --> UC2[ç™»å½•ç³»ç»Ÿ]
    User --> UC3[ä¿®æ”¹ä¸ªäººä¿¡æ¯]
    User --> UC4[é‡ç½®å¯†ç ]
    
    Admin --> UC5[ç”¨æˆ·ç®¡ç†]
    Admin --> UC6[æƒé™åˆ†é…]
    Admin --> UC7[ç³»ç»Ÿç›‘æ§]
```

### é¡¹ç›®ç®¡ç†ç”¨ä¾‹
```mermaid
graph TB
    ProjectManager[é¡¹ç›®ç»ç†]
    Developer[å¼€å‘è€…]
    Analyst[åˆ†æå¸ˆ]
    
    ProjectManager --> UC1[åˆ›å»ºé¡¹ç›®]
    ProjectManager --> UC2[åˆ é™¤é¡¹ç›®]
    ProjectManager --> UC3[é‚€è¯·æˆå‘˜]
    ProjectManager --> UC4[è®¾ç½®æƒé™]
    
    Developer --> UC5[æŸ¥çœ‹é¡¹ç›®]
    Developer --> UC6[ç¼–è¾‘æ–‡æ¡£]
    Developer --> UC7[ä¸Šä¼ ä»£ç ]
    
    Analyst --> UC8[åˆ†æéœ€æ±‚]
    Analyst --> UC9[ç”Ÿæˆæ–‡æ¡£]
    Analyst --> UC10[å¯¼å‡ºæŠ¥å‘Š]
```

### æ ¸å¿ƒä¸šåŠ¡èµ„äº§ç”¨ä¾‹
```mermaid
graph TB
    BusinessAnalyst[ä¸šåŠ¡åˆ†æå¸ˆ]
    SystemDesigner[ç³»ç»Ÿè®¾è®¡å¸ˆ]
    
    BusinessAnalyst --> UC1[è®¾è®¡ç”¨ä¾‹å›¾]
    BusinessAnalyst --> UC2[å®šä¹‰ä¸šåŠ¡æµç¨‹]
    BusinessAnalyst --> UC3[å»ºç«‹é¢†åŸŸæ¨¡å‹]
    
    SystemDesigner --> UC4[è®¾è®¡ç³»ç»Ÿæ¶æ„]
    SystemDesigner --> UC5[å®šä¹‰æ•°æ®æ¨¡å‹]
    SystemDesigner --> UC6[ç”ŸæˆæŠ€æœ¯æ–‡æ¡£]
    
    UC1 --> UC7[ç”ŸæˆMermaidå›¾è¡¨]
    UC2 --> UC7
    UC3 --> UC7
    UC4 --> UC7
    UC5 --> UC7
```

## ğŸ—„ï¸ æ•°æ®æ¨¡å‹è®¾è®¡

### æ ¸å¿ƒå®ä½“å®šä¹‰

#### ç”¨æˆ·å®ä½“ (User)
```typescript
interface User {
  id: string;
  username: string;
  email: string;
  password_hash: string;
  full_name: string;
  avatar_url?: string;
  role: 'admin' | 'manager' | 'developer' | 'analyst';
  status: 'active' | 'inactive' | 'suspended';
  created_at: Date;
  updated_at: Date;
  last_login_at?: Date;
}
```

#### é¡¹ç›®å®ä½“ (Project)
```typescript
interface Project {
  id: string;
  name: string;
  description: string;
  type: 'web' | 'mobile' | 'desktop' | 'api' | 'other';
  tech_stack: string[];
  status: 'planning' | 'development' | 'testing' | 'completed' | 'archived';
  owner_id: string;
  git_repository?: {
    url: string;
    branch: string;
    access_token?: string;
  };
  created_at: Date;
  updated_at: Date;
}
```

#### ç”¨ä¾‹å›¾å®ä½“ (UseCase)
```typescript
interface UseCase {
  id: string;
  project_id: string;
  name: string;
  description: string;
  actors: Actor[];
  use_cases: UseCaseItem[];
  relationships: Relationship[];
  mermaid_code: string;
  created_by: string;
  created_at: Date;
  updated_at: Date;
}

interface Actor {
  id: string;
  name: string;
  type: 'primary' | 'secondary' | 'system';
  description: string;
}

interface UseCaseItem {
  id: string;
  name: string;
  description: string;
  priority: 'high' | 'medium' | 'low';
  complexity: 'simple' | 'medium' | 'complex';
}

interface Relationship {
  id: string;
  source_id: string;
  target_id: string;
  type: 'association' | 'include' | 'extend' | 'generalization';
  description?: string;
}
```

#### é¢†åŸŸæ¨¡å‹å®ä½“ (DomainModel)
```typescript
interface DomainModel {
  id: string;
  project_id: string;
  name: string;
  description: string;
  entities: DomainEntity[];
  relationships: DomainRelationship[];
  mermaid_code: string;
  created_by: string;
  created_at: Date;
  updated_at: Date;
}

interface DomainEntity {
  id: string;
  name: string;
  description: string;
  attributes: EntityAttribute[];
  methods: EntityMethod[];
  stereotype?: string;
}

interface EntityAttribute {
  id: string;
  name: string;
  type: string;
  description: string;
  is_key: boolean;
  is_required: boolean;
}

interface EntityMethod {
  id: string;
  name: string;
  description: string;
  parameters: string[];
  return_type: string;
}

interface DomainRelationship {
  id: string;
  source_entity_id: string;
  target_entity_id: string;
  type: 'association' | 'aggregation' | 'composition' | 'inheritance' | 'dependency';
  cardinality: string;
  description?: string;
}
```

#### æ–‡æ¡£å®ä½“ (Document)
```typescript
interface Document {
  id: string;
  project_id: string;
  name: string;
  type: 'requirement' | 'design' | 'api' | 'user_manual' | 'technical' | 'custom';
  content: string;
  template_id?: string;
  status: 'draft' | 'review' | 'approved' | 'published';
  version: string;
  tags: string[];
  created_by: string;
  created_at: Date;
  updated_at: Date;
}
```

#### ä»£ç åˆ†æå®ä½“ (CodeAnalysis)
```typescript
interface CodeAnalysis {
  id: string;
  project_id: string;
  file_path: string;
  file_type: string;
  analysis_result: {
    classes: ClassInfo[];
    functions: FunctionInfo[];
    dependencies: DependencyInfo[];
    metrics: CodeMetrics;
  };
  created_at: Date;
}

interface ClassInfo {
  name: string;
  methods: string[];
  properties: string[];
  extends?: string;
  implements?: string[];
}

interface FunctionInfo {
  name: string;
  parameters: string[];
  return_type: string;
  complexity: number;
}

interface DependencyInfo {
  source: string;
  target: string;
  type: 'import' | 'inheritance' | 'composition' | 'usage';
}

interface CodeMetrics {
  lines_of_code: number;
  cyclomatic_complexity: number;
  maintainability_index: number;
  technical_debt: number;
}
```

## ğŸ“Š ERå›¾è®¾è®¡

```mermaid
erDiagram
    User {
        string id PK
        string username UK
        string email UK
        string password_hash
        string full_name
        string avatar_url
        enum role
        enum status
        datetime created_at
        datetime updated_at
        datetime last_login_at
    }
    
    Project {
        string id PK
        string name
        string description
        enum type
        json tech_stack
        enum status
        string owner_id FK
        json git_repository
        datetime created_at
        datetime updated_at
    }
    
    ProjectMember {
        string id PK
        string project_id FK
        string user_id FK
        enum role
        datetime joined_at
    }
    
    UseCase {
        string id PK
        string project_id FK
        string name
        string description
        json actors
        json use_cases
        json relationships
        text mermaid_code
        string created_by FK
        datetime created_at
        datetime updated_at
    }
    
    DomainModel {
        string id PK
        string project_id FK
        string name
        string description
        json entities
        json relationships
        text mermaid_code
        string created_by FK
        datetime created_at
        datetime updated_at
    }
    
    Document {
        string id PK
        string project_id FK
        string name
        enum type
        text content
        string template_id FK
        enum status
        string version
        json tags
        string created_by FK
        datetime created_at
        datetime updated_at
    }
    
    CodeAnalysis {
        string id PK
        string project_id FK
        string file_path
        string file_type
        json analysis_result
        datetime created_at
    }
    
    Template {
        string id PK
        string name
        string description
        enum type
        json schema
        text content_template
        boolean is_public
        string created_by FK
        datetime created_at
        datetime updated_at
    }
    
    File {
        string id PK
        string project_id FK
        string name
        string path
        string mime_type
        integer size
        string storage_url
        string uploaded_by FK
        datetime uploaded_at
    }
    
    User ||--o{ Project : owns
    User ||--o{ ProjectMember : belongs_to
    Project ||--o{ ProjectMember : has
    Project ||--o{ UseCase : contains
    Project ||--o{ DomainModel : contains
    Project ||--o{ Document : contains
    Project ||--o{ CodeAnalysis : contains
    Project ||--o{ File : contains
    User ||--o{ UseCase : creates
    User ||--o{ DomainModel : creates
    User ||--o{ Document : creates
    User ||--o{ Template : creates
    User ||--o{ File : uploads
    Template ||--o{ Document : generates
```

## ğŸ”Œ APIæ¥å£è®¾è®¡

### åŸºç¡€é…ç½®
- **Base URL**: `https://api.design-tool.com/v1`
- **è®¤è¯æ–¹å¼**: JWT Bearer Token
- **æ•°æ®æ ¼å¼**: JSON
- **HTTPçŠ¶æ€ç **: æ ‡å‡†RESTfulçŠ¶æ€ç 

### 1. ç”¨æˆ·ç®¡ç†API

#### ç”¨æˆ·æ³¨å†Œ
```http
POST /auth/register
Content-Type: application/json

{
  "username": "string",
  "email": "string",
  "password": "string",
  "full_name": "string"
}

Response 201:
{
  "success": true,
  "data": {
    "user": {
      "id": "string",
      "username": "string",
      "email": "string",
      "full_name": "string",
      "role": "developer"
    },
    "token": "string"
  }
}
```

#### ç”¨æˆ·ç™»å½•
```http
POST /auth/login
Content-Type: application/json

{
  "email": "string",
  "password": "string"
}

Response 200:
{
  "success": true,
  "data": {
    "user": {
      "id": "string",
      "username": "string",
      "email": "string",
      "full_name": "string",
      "role": "developer"
    },
    "token": "string",
    "expires_in": 3600
  }
}
```

### 2. é¡¹ç›®ç®¡ç†API

#### åˆ›å»ºé¡¹ç›®
```http
POST /projects
Authorization: Bearer {token}
Content-Type: application/json

{
  "name": "string",
  "description": "string",
  "type": "web",
  "tech_stack": ["React", "Node.js", "MongoDB"],
  "git_repository": {
    "url": "string",
    "branch": "main",
    "access_token": "string"
  }
}

Response 201:
{
  "success": true,
  "data": {
    "id": "string",
    "name": "string",
    "description": "string",
    "type": "web",
    "status": "planning",
    "created_at": "2024-01-01T00:00:00Z"
  }
}
```

#### è·å–é¡¹ç›®åˆ—è¡¨
```http
GET /projects?page=1&limit=10&status=active
Authorization: Bearer {token}

Response 200:
{
  "success": true,
  "data": {
    "projects": [
      {
        "id": "string",
        "name": "string",
        "description": "string",
        "type": "web",
        "status": "development",
        "created_at": "2024-01-01T00:00:00Z"
      }
    ],
    "pagination": {
      "page": 1,
      "limit": 10,
      "total": 25,
      "pages": 3
    }
  }
}
```

### 3. ç”¨ä¾‹å›¾ç®¡ç†API

#### åˆ›å»ºç”¨ä¾‹å›¾
```http
POST /projects/{projectId}/use-cases
Authorization: Bearer {token}
Content-Type: application/json

{
  "name": "ç”¨æˆ·ç®¡ç†ç”¨ä¾‹å›¾",
  "description": "æè¿°ç”¨æˆ·æ³¨å†Œã€ç™»å½•ç­‰åŠŸèƒ½",
  "actors": [
    {
      "id": "actor1",
      "name": "ç”¨æˆ·",
      "type": "primary",
      "description": "ç³»ç»Ÿçš„ä¸»è¦ä½¿ç”¨è€…"
    }
  ],
  "use_cases": [
    {
      "id": "uc1",
      "name": "ç”¨æˆ·æ³¨å†Œ",
      "description": "æ–°ç”¨æˆ·æ³¨å†Œè´¦æˆ·",
      "priority": "high",
      "complexity": "medium"
    }
  ],
  "relationships": [
    {
      "id": "rel1",
      "source_id": "actor1",
      "target_id": "uc1",
      "type": "association"
    }
  ]
}

Response 201:
{
  "success": true,
  "data": {
    "id": "string",
    "name": "ç”¨æˆ·ç®¡ç†ç”¨ä¾‹å›¾",
    "mermaid_code": "graph TB\n  User[ç”¨æˆ·] --> UC1[ç”¨æˆ·æ³¨å†Œ]",
    "created_at": "2024-01-01T00:00:00Z"
  }
}
```

#### ç”Ÿæˆç”¨ä¾‹å›¾Mermaidä»£ç 
```http
POST /projects/{projectId}/use-cases/{useCaseId}/generate-mermaid
Authorization: Bearer {token}

Response 200:
{
  "success": true,
  "data": {
    "mermaid_code": "graph TB\n  User[ç”¨æˆ·] --> UC1[ç”¨æˆ·æ³¨å†Œ]\n  User --> UC2[ç”¨æˆ·ç™»å½•]",
    "svg_content": "<svg>...</svg>"
  }
}
```

### 4. é¢†åŸŸæ¨¡å‹ç®¡ç†API

#### åˆ›å»ºé¢†åŸŸæ¨¡å‹
```http
POST /projects/{projectId}/domain-models
Authorization: Bearer {token}
Content-Type: application/json

{
  "name": "ç”µå•†é¢†åŸŸæ¨¡å‹",
  "description": "ç”µå•†ç³»ç»Ÿçš„æ ¸å¿ƒä¸šåŠ¡æ¨¡å‹",
  "entities": [
    {
      "id": "entity1",
      "name": "User",
      "description": "ç”¨æˆ·å®ä½“",
      "attributes": [
        {
          "id": "attr1",
          "name": "id",
          "type": "string",
          "description": "ç”¨æˆ·ID",
          "is_key": true,
          "is_required": true
        }
      ],
      "methods": [
        {
          "id": "method1",
          "name": "login",
          "description": "ç”¨æˆ·ç™»å½•",
          "parameters": ["email", "password"],
          "return_type": "boolean"
        }
      ]
    }
  ],
  "relationships": [
    {
      "id": "rel1",
      "source_entity_id": "entity1",
      "target_entity_id": "entity2",
      "type": "association",
      "cardinality": "1:N"
    }
  ]
}

Response 201:
{
  "success": true,
  "data": {
    "id": "string",
    "name": "ç”µå•†é¢†åŸŸæ¨¡å‹",
    "mermaid_code": "classDiagram\n  class User {\n    +string id\n    +login(email, password) boolean\n  }",
    "created_at": "2024-01-01T00:00:00Z"
  }
}
```

### 5. æ–‡æ¡£ç”ŸæˆAPI

#### AIåˆ†æéœ€æ±‚å¹¶ç”Ÿæˆæ–‡æ¡£
```http
POST /projects/{projectId}/documents/ai-generate
Authorization: Bearer {token}
Content-Type: application/json

{
  "requirements": "å¼€å‘ä¸€ä¸ªç”µå•†å¹³å°ï¼ŒåŒ…å«ç”¨æˆ·ç®¡ç†ã€å•†å“ç®¡ç†ã€è®¢å•ç®¡ç†ç­‰åŠŸèƒ½",
  "document_types": ["requirement", "design", "api"],
  "template_id": "template123",
  "options": {
    "include_diagrams": true,
    "detail_level": "high",
    "language": "zh-CN"
  }
}

Response 202:
{
  "success": true,
  "data": {
    "task_id": "string",
    "status": "processing",
    "estimated_time": 300
  }
}
```

#### æŸ¥è¯¢æ–‡æ¡£ç”ŸæˆçŠ¶æ€
```http
GET /projects/{projectId}/documents/generate-status/{taskId}
Authorization: Bearer {token}

Response 200:
{
  "success": true,
  "data": {
    "task_id": "string",
    "status": "completed",
    "progress": 100,
    "result": {
      "documents": [
        {
          "id": "string",
          "name": "éœ€æ±‚è§„æ ¼è¯´æ˜ä¹¦",
          "type": "requirement",
          "content": "...",
          "created_at": "2024-01-01T00:00:00Z"
        }
      ]
    }
  }
}
```

### 6. ä»£ç åˆ†æAPI

#### ä¸Šä¼ ä»£ç æ–‡ä»¶è¿›è¡Œåˆ†æ
```http
POST /projects/{projectId}/code-analysis/upload
Authorization: Bearer {token}
Content-Type: multipart/form-data

files: [File, File, ...]
options: {
  "analyze_dependencies": true,
  "generate_diagrams": true,
  "include_metrics": true
}

Response 202:
{
  "success": true,
  "data": {
    "task_id": "string",
    "status": "processing",
    "uploaded_files": 15
  }
}
```

#### è·å–ä»£ç åˆ†æç»“æœ
```http
GET /projects/{projectId}/code-analysis/{taskId}
Authorization: Bearer {token}

Response 200:
{
  "success": true,
  "data": {
    "analysis_id": "string",
    "status": "completed",
    "result": {
      "file_structure": {
        "total_files": 25,
        "by_type": {
          "typescript": 15,
          "javascript": 8,
          "css": 2
        }
      },
      "classes": [
        {
          "name": "UserService",
          "methods": ["login", "register", "updateProfile"],
          "properties": ["users", "config"],
          "file_path": "src/services/UserService.ts"
        }
      ],
      "dependencies": [
        {
          "source": "UserService",
          "target": "DatabaseService",
          "type": "composition"
        }
      ],
      "metrics": {
        "total_lines": 5420,
        "complexity_score": 7.2,
        "maintainability_index": 85
      },
      "diagrams": {
        "class_diagram": "classDiagram\n  class UserService...",
        "dependency_diagram": "graph TD\n  UserService --> DatabaseService"
      }
    }
  }
}
```

### 7. æ–‡ä»¶ç®¡ç†API

#### ä¸Šä¼ æ–‡ä»¶
```http
POST /projects/{projectId}/files/upload
Authorization: Bearer {token}
Content-Type: multipart/form-data

file: File
metadata: {
  "description": "åŸå‹å›¾æ–‡ä»¶",
  "tags": ["prototype", "ui"]
}

Response 201:
{
  "success": true,
  "data": {
    "id": "string",
    "name": "prototype.png",
    "size": 1024000,
    "mime_type": "image/png",
    "storage_url": "https://storage.example.com/files/...",
    "uploaded_at": "2024-01-01T00:00:00Z"
  }
}
```

### 8. Gité›†æˆAPI

#### è¿æ¥Gitä»“åº“
```http
POST /projects/{projectId}/git/connect
Authorization: Bearer {token}
Content-Type: application/json

{
  "repository_url": "https://github.com/user/repo.git",
  "branch": "main",
  "access_token": "github_token",
  "auto_sync": true
}

Response 200:
{
  "success": true,
  "data": {
    "connection_id": "string",
    "status": "connected",
    "last_sync": "2024-01-01T00:00:00Z"
  }
}
```

#### æäº¤æ–‡æ¡£åˆ°Git
```http
POST /projects/{projectId}/git/commit
Authorization: Bearer {token}
Content-Type: application/json

{
  "document_ids": ["doc1", "doc2"],
  "commit_message": "æ›´æ–°éœ€æ±‚æ–‡æ¡£å’Œè®¾è®¡æ–‡æ¡£",
  "branch": "feature/docs-update"
}

Response 202:
{
  "success": true,
  "data": {
    "commit_id": "string",
    "status": "processing"
  }
}
```

### 9. MCPåè®®API

#### MCPæœåŠ¡å™¨çŠ¶æ€
```http
GET /mcp/status
Authorization: Bearer {token}

Response 200:
{
  "success": true,
  "data": {
    "server_status": "running",
    "version": "1.0.0",
    "supported_protocols": ["mcp-1.0"],
    "available_tools": [
      "generate_use_case",
      "generate_domain_model",
      "analyze_code",
      "generate_document"
    ]
  }
}
```

#### MCPå·¥å…·è°ƒç”¨
```http
POST /mcp/tools/invoke
Authorization: Bearer {token}
Content-Type: application/json

{
  "tool_name": "generate_use_case",
  "parameters": {
    "requirements": "ç”¨æˆ·ç™»å½•ç³»ç»Ÿ",
    "project_id": "project123"
  }
}

Response 200:
{
  "success": true,
  "data": {
    "tool_result": {
      "use_case_id": "string",
      "mermaid_code": "graph TB...",
      "actors": [...],
      "use_cases": [...]
    }
  }
}
```

## ğŸ”’ å®‰å…¨æ€§è¦æ±‚

### è®¤è¯ä¸æˆæƒ
- JWT Tokenè®¤è¯ï¼Œæœ‰æ•ˆæœŸ24å°æ—¶
- åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶(RBAC)
- APIå¯†é’¥ç®¡ç†
- OAuth2.0é›†æˆæ”¯æŒ

### æ•°æ®å®‰å…¨
- æ•æ„Ÿæ•°æ®åŠ å¯†å­˜å‚¨
- HTTPSå¼ºåˆ¶ä¼ è¾“
- è¾“å…¥éªŒè¯å’ŒSQLæ³¨å…¥é˜²æŠ¤
- æ–‡ä»¶ä¸Šä¼ å®‰å…¨æ£€æŸ¥

### è®¿é—®æ§åˆ¶
- é¡¹ç›®çº§åˆ«æƒé™æ§åˆ¶
- èµ„æºè®¿é—®æ—¥å¿—è®°å½•
- é¢‘ç‡é™åˆ¶(Rate Limiting)
- CORSé…ç½®

## ğŸ“ˆ æ€§èƒ½è¦æ±‚

### å“åº”æ—¶é—´
- APIå“åº”æ—¶é—´ < 500ms
- æ–‡ä»¶ä¸Šä¼ æ”¯æŒæ–­ç‚¹ç»­ä¼ 
- å¤§æ–‡ä»¶å¼‚æ­¥å¤„ç†
- ç¼“å­˜ç­–ç•¥ä¼˜åŒ–

### å¹¶å‘å¤„ç†
- æ”¯æŒ1000+å¹¶å‘ç”¨æˆ·
- æ•°æ®åº“è¿æ¥æ± ç®¡ç†
- é˜Ÿåˆ—ç³»ç»Ÿå¤„ç†è€—æ—¶ä»»åŠ¡
- è´Ÿè½½å‡è¡¡æ”¯æŒ

### å¯æ‰©å±•æ€§
- å¾®æœåŠ¡æ¶æ„è®¾è®¡
- æ°´å¹³æ‰©å±•æ”¯æŒ
- æ•°æ®åº“åˆ†ç‰‡ç­–ç•¥
- CDNé›†æˆ

## ğŸ§ª æµ‹è¯•è¦æ±‚

### APIæµ‹è¯•
- å•å…ƒæµ‹è¯•è¦†ç›–ç‡ > 80%
- é›†æˆæµ‹è¯•è¦†ç›–æ ¸å¿ƒæµç¨‹
- æ€§èƒ½æµ‹è¯•å’Œå‹åŠ›æµ‹è¯•
- å®‰å…¨æµ‹è¯•å’Œæ¸—é€æµ‹è¯•

### æ–‡æ¡£è¦æ±‚
- OpenAPI 3.0è§„èŒƒ
- Postmané›†åˆ
- SDKå’Œç¤ºä¾‹ä»£ç 
- é”™è¯¯ç è¯´æ˜æ–‡æ¡£

---

*æ–‡æ¡£ç‰ˆæœ¬: v1.0*  
*æœ€åæ›´æ–°: 2024å¹´12æœˆ*  
*è´Ÿè´£äºº: åç«¯å¼€å‘å›¢é˜Ÿ*